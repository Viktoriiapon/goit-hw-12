{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\n\nconst refs = {\n  formEl: document.querySelector('.js-search-form'),\n  infoEl: document.querySelector('.js-list-img'),\n  loaderEl: document.querySelector('.loader'),\n  loadMoreBtnEl: document.querySelector('.btn-load'),\n  \n};\n\nlet page = 1;\nlet userQuery = '';\nlet totalPages = 0;\nconst per_page = 15;\nrefs.loaderEl.classList.add('hidden');\nrefs.formEl.addEventListener('submit', onFormSubmit);\nrefs.loadMoreBtnEl.addEventListener('click', onLoadMore);\n\nasync function onFormSubmit(e) {\n  e.preventDefault();\n  page = 1;\n  userQuery = e.target.elements.query.value.trim();\n  refs.infoEl.innerHTML = '';\n  refs.loadMoreBtnEl.classList.add('hidden');\n  refs.loaderEl.style.display = 'block';\n  try {\n    const data = await getImage(userQuery, page);\n    if (data.hits.length === 0) {\n      iziToast.warning({\n        position: 'topRight',\n        messageSize: '30',\n        message: 'Please enter another search query.',\n      });\n    } else {\n      renderGallery(data);\n      refs.loadMoreBtnEl.style.display = 'block';\n      refs.loadMoreBtnEl.classList.remove('hidden');\n\n    }\n  } catch (error) {\n    iziToast.error({\n      position: 'topRight',\n      messageSize: '30',\n      message: 'Failed to fetch images. Please try again later.',\n    });\n  } finally {\n    refs.loaderEl.style.display = 'none';\n    e.target.elements.query.value = '';\n    \n  }\n}\n\nasync function onLoadMore() {\n  page += 1;\n  \n  try {\n    const data = await getImage(userQuery, page);\n    appendImages(data);\n    if (page >= totalPages) {\n      hideButton();\n      iziToast.info({\n        position: 'topRight',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n    smoothScroll();\n  } catch (error) {\n    iziToast.error({\n      position: 'topRight',\n      messageSize: '30',\n      message: 'Failed to fetch more images. Please try again later.',\n    });\n  } finally {\n    refs.loaderEl.style.display = 'none';\n  }\n}\n\nfunction smoothScroll() {\n  const cardHeight = refs.infoEl.firstElementChild.getBoundingClientRect().height;\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth'\n  });\n}\n\nfunction hideButton() {\n  refs.loadMoreBtnEl.classList.add('hidden');\n}\n\nasync function getImage(nameImage, page) {\n  const params = {\n    key: '42187150-1e170edc08d41224404163b7f',\n    q: nameImage,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page: page,\n  };\n  const url = `https://pixabay.com/api/?`;\n  const response = await axios.get(url, { params });\n  return response.data;\n}\n\nfunction imageTemplate(nameImage) {\n  const {\n    webformatURL,\n    largeImageURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = nameImage;\n  return `<div class=\"image js-image\">\n    <div class=\"image-container\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img\n          src=\"${webformatURL}\"\n          alt=\"${tags}\"\n          class=\"image js-image\"\n        />\n      </a>\n    </div>\n    <div class=\"image-body\">\n      <ul class=\"info\">\n        <li class=\"info-item\">\n          <b class=\"info-item-title\">Likes</b>\n          <span class=\"info-item-value\">${likes}</span>\n        </li>\n        <li class=\"info-item\">\n          <b class=\"info-item-title\">Views</b>\n          <span class=\"info-item-value\">${views}</span>\n        </li>\n        <li class=\"info-item\">\n          <b class=\"info-item-title\">Comments</b>\n          <span class=\"info-item-value\">${comments}</span>\n        </li>\n        <li class=\"info-item\">\n          <b class=\"info-item-title\">Downloads</b>\n          <span class=\"info-item-value\">${downloads}</span>\n        </li>\n      </ul>\n    </div>\n  </div>`;\n}\n\nfunction renderGallery({ hits, totalHits }) {\n  totalPages= Math.ceil(totalHits / per_page)\n\n  const markup = hits.map(imageTemplate).join('');\n  refs.infoEl.innerHTML = markup;\n  const lightbox = new SimpleLightbox('.gallery-link', {\n    captionDelay: 250,\n    captionsData: 'alt',\n  });\n  lightbox.refresh();\n}\n\nfunction appendImages({ hits, totalHits }) {\n  const markup = hits.map(imageTemplate).join('');\n  refs.infoEl.insertAdjacentHTML('beforeend', markup);\n}\n"],"names":["refs","page","userQuery","totalPages","per_page","onFormSubmit","onLoadMore","e","data","getImage","iziToast","renderGallery","appendImages","hideButton","smoothScroll","cardHeight","nameImage","params","url","axios","imageTemplate","webformatURL","largeImageURL","tags","likes","views","comments","downloads","hits","totalHits","markup","SimpleLightbox"],"mappings":"owBAOA,MAAMA,EAAO,CACX,OAAQ,SAAS,cAAc,iBAAiB,EAChD,OAAQ,SAAS,cAAc,cAAc,EAC7C,SAAU,SAAS,cAAc,SAAS,EAC1C,cAAe,SAAS,cAAc,WAAW,CAEnD,EAEA,IAAIC,EAAO,EACPC,EAAY,GACZC,EAAa,EACjB,MAAMC,EAAW,GACjBJ,EAAK,SAAS,UAAU,IAAI,QAAQ,EACpCA,EAAK,OAAO,iBAAiB,SAAUK,CAAY,EACnDL,EAAK,cAAc,iBAAiB,QAASM,CAAU,EAEvD,eAAeD,EAAaE,EAAG,CAC7BA,EAAE,eAAc,EAChBN,EAAO,EACPC,EAAYK,EAAE,OAAO,SAAS,MAAM,MAAM,OAC1CP,EAAK,OAAO,UAAY,GACxBA,EAAK,cAAc,UAAU,IAAI,QAAQ,EACzCA,EAAK,SAAS,MAAM,QAAU,QAC9B,GAAI,CACF,MAAMQ,EAAO,MAAMC,EAASP,EAAWD,CAAI,EACvCO,EAAK,KAAK,SAAW,EACvBE,EAAS,QAAQ,CACf,SAAU,WACV,YAAa,KACb,QAAS,oCACjB,CAAO,GAEDC,EAAcH,CAAI,EAClBR,EAAK,cAAc,MAAM,QAAU,QACnCA,EAAK,cAAc,UAAU,OAAO,QAAQ,EAG/C,MAAe,CACdU,EAAS,MAAM,CACb,SAAU,WACV,YAAa,KACb,QAAS,iDACf,CAAK,CACL,QAAY,CACRV,EAAK,SAAS,MAAM,QAAU,OAC9BO,EAAE,OAAO,SAAS,MAAM,MAAQ,EAEjC,CACH,CAEA,eAAeD,GAAa,CAC1BL,GAAQ,EAER,GAAI,CACF,MAAMO,EAAO,MAAMC,EAASP,EAAWD,CAAI,EAC3CW,EAAaJ,CAAI,EACbP,GAAQE,IACVU,IACAH,EAAS,KAAK,CACZ,SAAU,WACV,QAAS,4DACjB,CAAO,GAEHI,GACD,MAAe,CACdJ,EAAS,MAAM,CACb,SAAU,WACV,YAAa,KACb,QAAS,sDACf,CAAK,CACL,QAAY,CACRV,EAAK,SAAS,MAAM,QAAU,MAC/B,CACH,CAEA,SAASc,GAAe,CACtB,MAAMC,EAAaf,EAAK,OAAO,kBAAkB,sBAAuB,EAAC,OACzE,OAAO,SAAS,CACd,IAAKe,EAAa,EAClB,SAAU,QACd,CAAG,CACH,CAEA,SAASF,GAAa,CACpBb,EAAK,cAAc,UAAU,IAAI,QAAQ,CAC3C,CAEA,eAAeS,EAASO,EAAWf,EAAM,CACvC,MAAMgB,EAAS,CACb,IAAK,qCACL,EAAGD,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAMf,CACV,EACQiB,EAAM,4BAEZ,OADiB,MAAMC,EAAM,IAAID,EAAK,CAAE,OAAAD,CAAM,CAAE,GAChC,IAClB,CAEA,SAASG,EAAcJ,EAAW,CAChC,KAAM,CACJ,aAAAK,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACD,EAAGX,EACJ,MAAO;AAAA;AAAA,sCAE6BM,CAAa;AAAA;AAAA,iBAElCD,CAAY;AAAA,iBACZE,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CASqBC,CAAK;AAAA;AAAA;AAAA;AAAA,0CAILC,CAAK;AAAA;AAAA;AAAA;AAAA,0CAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,0CAIRC,CAAS;AAAA;AAAA;AAAA;AAAA,SAKnD,CAEA,SAAShB,EAAc,CAAE,KAAAiB,EAAM,UAAAC,GAAa,CAC1C1B,EAAY,KAAK,KAAK0B,EAAYzB,CAAQ,EAE1C,MAAM0B,EAASF,EAAK,IAAIR,CAAa,EAAE,KAAK,EAAE,EAC9CpB,EAAK,OAAO,UAAY8B,EACP,IAAIC,EAAe,gBAAiB,CACnD,aAAc,IACd,aAAc,KAClB,CAAG,EACQ,QAAO,CAClB,CAEA,SAASnB,EAAa,CAAE,KAAAgB,EAAM,UAAAC,GAAa,CACzC,MAAMC,EAASF,EAAK,IAAIR,CAAa,EAAE,KAAK,EAAE,EAC9CpB,EAAK,OAAO,mBAAmB,YAAa8B,CAAM,CACpD"}